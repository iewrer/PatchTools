patchdir  = "quilt/patches":
sourcedir = "quilt":

PATCH: "resources/0023-capemgr-Retry-loading-when-failure-to-find-firmware.patch"
   DIFF: "diff --git a/drivers/misc/cape/beaglebone/capemgr.c b/drivers/misc/cape/beaglebone/capemgr.c"
      HUNK: "@@ -44,6 +44,8 @@"
      HUNK: "@@ -109,6 +111,7 @@ struct bone_cape_slot {"
      HUNK: "@@ -1282,6 +1285,10 @@ static int bone_capemgr_load(struct bone_cape_slot *slot)"
      HUNK: "@@ -1353,6 +1360,7 @@ static int bone_capemgr_load(struct bone_cape_slot *slot)"
         FIND:  "add"    line found at 1297: "	mutex_unlock(&info->capemap_mutex);"
         FIND:  "add"    line found at 1328: "	mutex_unlock(&info->capemap_mutex);"
         FIND:  "add"    line found at 1351: "	mutex_unlock(&info->capemap_mutex);"
         FIND:  "add"    line found at 1365: "	mutex_unlock(&info->capemap_mutex);"
         FIND:  "add"    line found at 1372: "	mutex_unlock(&info->capemap_mutex);"
         FIND:  "add"    line found at 1978: "	mutex_unlock(&info->capemap_mutex);"
      HUNK: "@@ -1362,15 +1370,12 @@ static int bone_capemgr_load(struct bone_cape_slot *slot)"
         WARN:  "merge"  line not found at 1365: "		goto err_fail_no_fw;"
         WARN:  "merge"  line not found at 1366: "	}"
         WARN:  "merge"  line not found at 1367: ""
         WARN:  "merge"  line not found at 1368: "	dev_info(dev, "slot #%d: dtbo '%s' loaded; converting to live tree\n","
         WARN:  "merge"  line not found at 1369: "			slot->slotno, slot->dtbo);"
         WARN:  "merge"  line not found at 1370: ""
         WARN:  "merge"  line not found at 1371: "	of_fdt_unflatten_tree((void *)slot->fw->data, &slot->overlay);"
         WARN:  "merge"  line not found at 1372: "	if (slot->overlay == NULL) {"
         WARN:  "merge"  line not found at 1373: "		dev_err(dev, "slot #%d: Failed to unflatten\n","
         FIND:  "merge"  line found at 1366: "		goto err_fail_no_fw;"
         FIND:  "merge"  line found at 1369: "	dev_info(dev, "slot #%d: dtbo '%s' loaded; converting to live tree\n","
         FIND:  "merge"  line found at 1370: "			slot->slotno, slot->dtbo);"
         FIND:  "merge"  line found at 1374: "	of_fdt_unflatten_tree((void *)slot->fw->data, &slot->overlay);"
         FIND:  "merge"  line found at 1375: "	if (slot->overlay == NULL) {"
         FIND:  "merge"  line found at 1376: "		dev_err(dev, "slot #%d: Failed to unflatten\n","
      HUNK: "@@ -1734,14 +1739,39 @@ err_no_mem:"
         INFO:  "change" line not found at 1737: "/* return 1 if it makes sense to retry loading */"
         ERROR: "add"    line found at 1738: "{"
         INFO:  "change" line not found at 1744: "	dev_dbg(dev, "loader: check slot-%d %s:%s (prio %d)\n", slot->slotno,"
         FIND:  "add"    line found at 500: "	struct bone_capemgr_info *info = slot->info;"
         FIND:  "add"    line found at 808: "	struct bone_capemgr_info *info = slot->info;"
         FIND:  "add"    line found at 878: "	struct bone_capemgr_info *info = slot->info;"
         FIND:  "add"    line found at 1162: "	struct bone_capemgr_info *info = slot->info;"
         FIND:  "add"    line found at 1271: "	struct bone_capemgr_info *info = slot->info;"
         FIND:  "add"    line found at 1468: "	struct bone_capemgr_info *info = slot->info;"
         FIND:  "add"    line found at 1498: "	struct bone_capemgr_info *info = slot->info;"
         FIND:  "add"    line found at 1739: "	struct bone_capemgr_info *info = slot->info;"
         FIND:  "add"    line found at 1765: "	struct bone_capemgr_info *info = slot->info;"
         FIND:  "add"    line found at 809: "	struct device *dev = &info->pdev->dev;"
         FIND:  "add"    line found at 879: "	struct device *dev = &info->pdev->dev;"
         FIND:  "add"    line found at 1133: "	struct device *dev = &info->pdev->dev;"
         FIND:  "add"    line found at 1153: "	struct device *dev = &info->pdev->dev;"
         FIND:  "add"    line found at 1163: "	struct device *dev = &info->pdev->dev;"
         FIND:  "add"    line found at 1272: "	struct device *dev = &info->pdev->dev;"
         FIND:  "add"    line found at 1469: "	struct device *dev = &info->pdev->dev;"
         FIND:  "add"    line found at 1620: "	struct device *dev = &info->pdev->dev;"
         FIND:  "add"    line found at 1741: "	struct device *dev = &info->pdev->dev;"
         FIND:  "add"    line found at 1766: "	struct device *dev = &info->pdev->dev;"
         FIND:  "add"    line found at 1167: "	struct bone_cape_slot *slotn;"
         FIND:  "add"    line found at 1745: "			slot->part_number, slot->version, slot->priority);"
         FIND:  "add"    line found at 1770: "			slot->part_number, slot->version, slot->priority);"
         FIND:  "add"    line found at 1786: "			slot->part_number, slot->version, slot->priority);"
         FIND:  "add"    line found at 984: "	mutex_lock(&info->slots_list_mutex);"
         FIND:  "add"    line found at 1023: "	mutex_lock(&info->slots_list_mutex);"
         FIND:  "add"    line found at 1206: "	mutex_lock(&info->slots_list_mutex);"
         FIND:  "add"    line found at 1501: "	mutex_lock(&info->slots_list_mutex);"
         FIND:  "add"    line found at 1716: "	mutex_lock(&info->slots_list_mutex);"
         FIND:  "add"    line found at 1747: "	mutex_lock(&info->slots_list_mutex);"
         FIND:  "add"    line found at 2076: "	mutex_lock(&info->slots_list_mutex);"
         FIND:  "add"    line found at 2129: "	mutex_lock(&info->slots_list_mutex);"
         FIND:  "add"    line found at 1218: "	list_for_each_entry(slotn, &info->slot_list, node) {"
         FIND:  "add"    line found at 1002: "	mutex_unlock(&info->slots_list_mutex);"
         FIND:  "add"    line found at 1029: "	mutex_unlock(&info->slots_list_mutex);"
         FIND:  "add"    line found at 1033: "	mutex_unlock(&info->slots_list_mutex);"
         FIND:  "add"    line found at 1264: "	mutex_unlock(&info->slots_list_mutex);"
         FIND:  "add"    line found at 1503: "	mutex_unlock(&info->slots_list_mutex);"
         FIND:  "add"    line found at 1718: "	mutex_unlock(&info->slots_list_mutex);"
         FIND:  "add"    line found at 1758: "	mutex_unlock(&info->slots_list_mutex);"
         FIND:  "add"    line found at 2108: "	mutex_unlock(&info->slots_list_mutex);"
         FIND:  "add"    line found at 2132: "	mutex_unlock(&info->slots_list_mutex);"
      HUNK: "@@ -1764,9 +1794,13 @@ static int bone_capemgr_loader(void *data)"
         INFO:  "change" line not found at 1767: "	int ret, done;"
         ERROR: "add"    line found at 1768: ""
         INFO:  "change" line not found at 1769: "	slot->retry_loading = 0;"
      HUNK: "@@ -1775,31 +1809,68 @@ static int bone_capemgr_loader(void *data)"
         ERROR: "delete" line not found at 1778: "	ret = wait_event_interruptible(info->load_wq, clear_to_load_condition(slot));"
         WARN:  "merge"  line not found at 1779: "	if (ret < 0) {"
         WARN:  "merge"  line not found at 1780: "		dev_info(dev, "loader, Signal pending\n");"
         WARN:  "merge"  line not found at 1781: "		return ret;"
         WARN:  "merge"  line not found at 1782: "	}"
         WARN:  "merge"  line not found at 1783: ""
         ERROR: "delete" line not found at 1784: "	dev_dbg(dev, "loader: after slot-%d %s:%s (prio %d)\n", slot->slotno,"
         WARN:  "merge"  line not found at 1785: "			slot->part_number, slot->version, slot->priority);"
         WARN:  "merge"  line not found at 1786: ""
         WARN:  "merge"  line not found at 1787: "	ret = bone_capemgr_load(slot);"
         WARN:  "merge"  line not found at 1788: ""
         ERROR: "delete" line not found at 1789: "	/* wake up all just in case */"
         WARN:  "merge"  line not found at 1790: ""
         WARN:  "merge"  line not found at 1791: "	if (ret == 0)"
         ERROR: "delete" line not found at 1792: "		goto done;"
         WARN:  "merge"  line not found at 1793: "			slot->slotno, slot->part_number, slot->version,"
         WARN:  "merge"  line not found at 1794: "			slot->priority);"
         ERROR: "delete" line not found at 1795: "	} else {"
         WARN:  "merge"  line not found at 1796: "		dev_err(dev, "loader: failed to load slot-%d %s:%s (prio %d)\n","
         WARN:  "merge"  line not found at 1797: "			slot->slotno, slot->part_number, slot->version,"
         WARN:  "merge"  line not found at 1798: "			slot->priority);"
         ERROR: "delete" line not found at 1799: "	}"
         WARN:  "merge"  line not found at 1801: "	/* not loaded? remove */"
         WARN:  "merge"  line not found at 1802: "	if (ret != 0)"
         FIND:  "merge"  line found at 1780: "	if (ret < 0) {"
         FIND:  "merge"  line found at 1781: "		dev_info(dev, "loader, Signal pending\n");"
         FIND:  "merge"  line found at 1745: "			slot->part_number, slot->version, slot->priority);"
         FIND:  "merge"  line found at 1770: "			slot->part_number, slot->version, slot->priority);"
         FIND:  "merge"  line found at 1786: "			slot->part_number, slot->version, slot->priority);"
         FIND:  "merge"  line found at 1116: "	ret = bone_capemgr_load(slot);"
         FIND:  "merge"  line found at 1788: "	ret = bone_capemgr_load(slot);"
         FIND:  "add"    line found at 1802: "	wake_up_interruptible_all(&info->load_wq);"
         FIND:  "merge"  line found at 1035: "	if (ret == 0)"
         FIND:  "merge"  line found at 1792: "	if (ret == 0)"
         FIND:  "add"    line found at 1745: "			slot->part_number, slot->version, slot->priority);"
         FIND:  "add"    line found at 1770: "			slot->part_number, slot->version, slot->priority);"
         FIND:  "add"    line found at 1786: "			slot->part_number, slot->version, slot->priority);"
         FIND:  "add"    line found at 1781: "			dev_info(dev, "loader, Signal pending\n");"
         FIND:  "add"    line found at 1116: "		ret = bone_capemgr_load(slot);"
         FIND:  "add"    line found at 1788: "		ret = bone_capemgr_load(slot);"
         FIND:  "add"    line found at 1035: "		if (ret == 0)"
         FIND:  "add"    line found at 1792: "		if (ret == 0)"
         FIND:  "add"    line found at 1802: "		wake_up_interruptible_all(&info->load_wq);"
         FIND:  "merge"  line found at 1794: "			slot->slotno, slot->part_number, slot->version,"
         FIND:  "merge"  line found at 1798: "			slot->slotno, slot->part_number, slot->version,"
         FIND:  "merge"  line found at 1795: "			slot->priority);"
         FIND:  "merge"  line found at 1799: "			slot->priority);"
         FIND:  "merge"  line found at 1797: "		dev_err(dev, "loader: failed to load slot-%d %s:%s (prio %d)\n","
         FIND:  "merge"  line found at 1794: "			slot->slotno, slot->part_number, slot->version,"
         FIND:  "merge"  line found at 1798: "			slot->slotno, slot->part_number, slot->version,"
         FIND:  "merge"  line found at 1795: "			slot->priority);"
         FIND:  "merge"  line found at 1799: "			slot->priority);"
         FIND:  "merge"  line found at 1804: "	/* not loaded? remove */"
         FIND:  "merge"  line found at 1118: "	if (ret != 0)"
         FIND:  "merge"  line found at 1137: "	if (ret != 0)"
         FIND:  "merge"  line found at 1141: "	if (ret != 0)"
         FIND:  "merge"  line found at 1805: "	if (ret != 0)"
   INFO:  8 patch errors

Summary:
   0 passed, 0 skipped, 1 tested
